<div domTreeChange (dom-changed)="domChange($event)" class="bg-default" *ngIf="isRendererSelected(); else selectServer">
    <!--                                                                -->
    <!-- Template : Browse Result General Container                     -->
    <!-- ############################################################## -->

    <!-- Top browsing element: Displays image and informations about current container -->
    <div *ngIf="showTopHeader" class="outer-container">
        <div class="header-container">
            <div class="top-img-container">
                <img class="image-container" src="{{currentContainer.albumartUri}}" class="img-top"
                    alt="select_media_server">
            </div>
            <div class="d-flex flex-column w-100 ps-4" id="ID_SCROLL_TO_ELEMENT_STEP_IN" tabindex="-1">
                <div class="right-button">
                    <div *ngIf="hasSongs(); else containerTitle">
                        <div class="d-flex flex-column mt-2">
                            <div class="title">{{currentContainer.title}}
                                <mat-icon *ngIf="isLiked()" (click)="dislikeAlbum()" class="me-1 liked" svgIcon="heart">
                                </mat-icon>
                                <mat-icon *ngIf="likePossible()" (click)="likeAlbum()" class="me-1 unliked"
                                    svgIcon="heart-outline"></mat-icon>
                            </div>
                            <div *ngIf="currentContainer.artist" class="regular">by <span
                                    class="highlight">{{currentContainer.artist}}</span>
                            </div>
                            <div *ngIf="itemsCount > 0" class="pt-3 regular">{{containerType}} contains <span
                                    class="highlight">{{itemsCount}}</span> audio title</div>
                            <div *ngIf="totalPlaytime.length > 0" class="pt-1 regular">Total play time <span
                                    class="highlight">{{totalPlaytime}}</span></div>
                        </div>
                        <div class="button-row">
                            <button mat-flat-button class="my-buttons" (click)="toggleListView()">
                                <mat-icon class="me-1" style="vertical-align: top;" svgIcon="{{switchViewIcon}}">
                                </mat-icon>
                                switch view
                            </button>
                            <button mat-flat-button class="my-buttons" (click)="playPlaylist(currentContainer)">
                                <mat-icon class="me-1" style="vertical-align: top;" svgIcon="play"></mat-icon>
                                play
                            </button>
                            <button mat-flat-button class="my-buttons" (click)="shufflePlaylist(currentContainer)">
                                <mat-icon class="me-1" style="vertical-align: top;" svgIcon="shuffle-variant">
                                </mat-icon>
                                shuffle
                            </button>
                            <button mat-flat-button class="my-buttons"
                                (click)="playlistService.addContainerToPlaylist(currentContainer)">
                                <mat-icon class="me-1" style="vertical-align: top;" svgIcon="playlist-plus"
                                    aria-label="add to playlist">
                                </mat-icon>
                                add tracks
                            </button>
                        </div>

                    </div>
                    <!-- minim server support -->
                    <button *ngIf="minimTagsList?.length > 0" mat-flat-button class="my-buttons"
                        (click)="openMinimTagDialog($event)">
                        <mat-icon class="me-1" style="vertical-align: top;" svgIcon="tag"></mat-icon>Tags
                    </button>
                    <!-- current content search box -->
                    <div class="d-flex mt-4">
                        <div class="search-container">
                            <mat-icon class="me-1 search-icon" svgIcon="card-search-outline"></mat-icon>
                            <input class="search" [(ngModel)]="quickSearchString" matInput placeholder="search content"
                                #searchInput (keyup)="keyUp($event)">
                            <mat-icon class="me-1 search-icon" svgIcon="close" (click)="clearSearch()"></mat-icon>
                        </div>
                    </div>
                </div>
                <div class="d-flex">
                    <div class="middle-spacer"></div>
                </div>
            </div>
        </div>
    </div>

    <ng-template #containerTitle>
        <div id="template_containerTitle" class="d-flex flex-column infobox align-self-start">
            <div class="title">{{currentContainer.title}}</div>
            <div *ngIf="albumList?.length > 0" class="regular"><span class="highlight pe-2">{{albumList?.length}}</span>
                Playlist<span *ngIf="albumList?.length > 1">s</span></div>
            <div *ngIf="playlistList.length > 0" class="regular"><span
                    class="highlight pe-2">{{playlistList.length}}</span>
                Playlist<span *ngIf="playlistList.length > 1">s</span></div>
            <div *ngIf="containerList.length > 0" class="regular"><span
                    class="highlight pe-2">{{containerList.length}}</span> Folder<span
                    *ngIf="containerList.length > 1">s</span></div>
            <div *ngIf="itemsCount > 0" class="regular"><span class="highlight pe-2">{{itemsCount}}</span> Track<span
                    *ngIf="itemsCount > 1">s</span></div>
        </div>
    </ng-template>

    <!--
        Main Content
        ==========================================
    -->
    <div class="outer-container">
        <div class="middle-spacer"></div>
        <div class="browseContentArea">
            <!--
            playlist elements on first position
            =================================================================
            -->
            <div *ngIf="playlistList?.length > 0">
                <div id="head_browse_result_playlist_items_ID" tabindex="-1" class="albumLayout">
                    <div id="{{container.id}}" tabindex="-1" class="albumTile" *ngFor="let container of playlistList">
                        <div class="image-container">
                            <div class="albumImageContainer">
                                <img src="{{container.albumartUri}}" alt="{{container.title}}">
                                <div class="play-overlay d-flex flex-column justify-content-center align-items-center">
                                    <div class="d-flex justify-content-center align-items-center">
                                        <mat-icon (click)="browseTo(container)" class="play-overlay-button"
                                            svgIcon="folder-move-outline" aria-label="step into folder">
                                        </mat-icon>
                                        <mat-icon (click)="playlistService.addContainerToPlaylist(container)"
                                            class="play-overlay-button" svgIcon="playlist-plus"
                                            aria-label="add to playlist">
                                        </mat-icon>
                                    </div>
                                    <div class="d-flex justify-content-center align-items-center">
                                        <mat-icon (click)="playPlaylist(container)" class="play-overlay-button"
                                            svgIcon="play" aria-label="app to playlist and play">
                                        </mat-icon>
                                        <mat-icon (click)="shufflePlaylist(container)" class="play-overlay-button"
                                            svgIcon="shuffle-variant" aria-label="app to playlist and shuffle play">
                                        </mat-icon>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="d-flex flex-column albumDesc" flex-column>
                            <div class="playlistText">PLAYLIST</div>
                            <div class="card-title">{{container.title}}</div>
                        </div>
                    </div>
                </div>
            </div>

            <!--                                                                -->
            <!-- Template : Browse Result Album                                 -->
            <!-- ############################################################## -->
            <div *ngIf="albumList?.length > 0">
                <div id="head_browse_result_album_ID" class="albumLayout">
                    <div id="{{container.id}}" tabindex="-1" class="albumTile" *ngFor="let container of albumList">
                        <div class="albumImageContainer">
                            <img src="{{container.albumartUri}}" alt="{{container.title}}">
                            <div
                                class="play-overlay-album d-flex flex-column justify-content-center align-items-center">
                                <div class="d-flex justify-content-center align-items-center">
                                    <mat-icon (click)="browseTo(container)" class="play-overlay-button-album"
                                        svgIcon="folder-move-outline" aria-label="step into folder">
                                    </mat-icon>
                                </div>
                                <div class="d-flex justify-content-center align-items-center">
                                    <mat-icon (click)="playAlbum(container)" class="play-overlay-button-album"
                                        svgIcon="play" aria-label="app to playlist and play">
                                    </mat-icon>
                                    <mat-icon (click)="playlistService.addContainerToPlaylist(container)"
                                        class="play-overlay-button-album" svgIcon="playlist-plus"
                                        aria-label="add to playlist">
                                    </mat-icon>
                                </div>
                            </div>
                        </div>
                        <div class="d-flex flex-column minWidth albumDesc">
                            <div class="albumTitle no-wrap">{{container.title}}</div>
                            <div class="albumSubheader no-wrap">{{container.artist}}</div>
                            <div class="albumYear no-wrap">{{container.media_date}}</div>
                        </div>
                    </div>
                </div>
            </div>


            <!--                                                                -->
            <!-- Template : Browse Result Items                                 -->
            <!-- ############################################################## -->
            <div id="{{topDivId}}" tabindex="-1" *ngIf="musicTracks.length > 0" class="itemDetails">
                <div *ngIf="isListView(); else mixedTitles">
                    <div id="head_browse_result_items_list_view_ID" class="container-fluid item-table">
                        <div class="item-thead">
                            <div class="row col-greyed">
                                <div *ngIf="!contentDirectoryService.allTracksSameAlbum()"
                                    class="col-3 col-sm-2 col-md-2 col-lg-1">&nbsp;</div>
                                <div *ngIf="contentDirectoryService.allTracksSameAlbum()" class="col-1">#</div>
                                <div class="{{getTitleResponsiveClass()}}">Title</div>
                                <div class="col-2 d-none d-md-block">Artist</div>
                                <div *ngIf="!contentDirectoryService.allTracksSameAlbum()"
                                    class="col-2 d-none d-lg-block">
                                    Album</div>
                                <div *ngIf="contentDirectoryService.oneTrackWithMusicBrainzId()"
                                    class="col-1 col-sm-2 col-lg-1 d-none text-right d-sm-block ">Rating
                                </div>
                                <div class="col-1 text-right mid-col d-none d-lg-block">LG</div>
                                <div class="col-1">&nbsp;</div>
                            </div>
                        </div>

                        <div id="{{item.objectID}}" *ngFor="let item of musicTracks">
                            <div class="item-tbody"
                                *ngIf="contentDirectoryService.allTracksSameAlbum() && !contentDirectoryService.allTracksSameDisc()">
                                <div *ngIf="newDiscLabel(item)" class="row">
                                    <div class="col disc-label">
                                        {{getDiscLabel(item)}}
                                    </div>
                                </div>
                            </div>
                            <div class="item-tbody">
                                <div class="row row-alignment">
                                    <div *ngIf="!contentDirectoryService.allTracksSameAlbum()"
                                        class="col-3 col-sm-2 col-md-2 col-lg-1" (click)="play(item)">
                                        <img class="img-small" src="{{item.albumArtUrl}}">
                                    </div>
                                    <div *ngIf="contentDirectoryService.allTracksSameAlbum()" (click)="play(item)"
                                        class="col-1 col-greyed">
                                        {{item.originalTrackNumber}}</div>
                                    <div (click)="play(item)"
                                        class="{{getTitleResponsiveClass()}} no-wrap d-flex justify-content-between">
                                        <div class="">{{item.title}}</div>
                                        <quality-badge [item]="item"></quality-badge>
                                    </div>
                                    <div (click)="play(item)" class="col-2 no-wrap d-none d-md-block">
                                        {{item.artistName}}
                                    </div>
                                    <div *ngIf="!contentDirectoryService.allTracksSameAlbum()" (click)="play(item)"
                                        class="col-2 no-wrap d-none d-lg-block">{{item.album}}</div>
                                    <div *ngIf="contentDirectoryService.oneTrackWithMusicBrainzId()"
                                        class="col-1 col-sm-2 col-lg-1 d-none d-sm-block ">
                                        <star-rating [currentSong]="item"></star-rating>
                                    </div>
                                    <div class="col-1 text-right d-none d-lg-block">{{getDuration(item)}}</div>
                                    <div class="col-1 col-greyed" (click)="showSongPopup($event, item)">
                                        &#x22EE;
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <ng-template #mixedTitles>
                    <div id="head_browse_result_items_mixed_titles_ID" class="mixedTitles">
                        <div id="{{item.objectID}}" class="cover-card" *ngFor="let item of musicTracks">
                            <img src="{{item.albumArtUrl}}" class="image-container" alt="{{item.title}}">
                            <div class="d-flex card-body">
                                <div class="d-flex">
                                    <div class="card-title">{{item.title}}</div>
                                </div>
                            </div>
                            <div class="play-overlay d-flex flex-column justify-content-end">
                                <div class="d-flex justify-content-around align-items-center pb-4">
                                    <div class="scaleBigger">
                                        <mat-icon (click)="avtransportService.playResource(item)"
                                            class="play-overlay-button" svgIcon="play-circle" aria-label="play">
                                        </mat-icon>
                                    </div>
                                    <div>
                                        <mat-icon (click)="playlistService.addToPlaylist(item)"
                                            class="play-overlay-button" svgIcon="playlist-plus" aria-label="play">
                                        </mat-icon>
                                    </div>
                                    <div>
                                        <mat-icon (click)="showSongPopup($event, item)" class="play-overlay-button"
                                            svgIcon="dots-vertical-circle-outline" aria-label="options">
                                        </mat-icon>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </ng-template>
            </div>

            <!--                                -->
            <!-- General container section      -->
            <!--                                -->
            <div *ngIf="containerList?.length > 0">
                <div id="head_browse_result_playlist_container_ID" class="albumLayout">
                    <div class="albumTile" id="{{container.id}}" tabindex="-1" (click)="browseTo(container)"
                        *ngFor="let container of containerList">
                        <div class="albumImageContainer">
                            <img class="image-container" src="{{container.albumartUri}}" alt="{{container.title}}">
                        </div>
                        <div class="d-flex flex-column albumDesc">
                            <div class="playlistText">{{getOtherContainerHeadline(container)}}</div>
                            <div class="albumTitle">{{container.title}}</div>
                        </div>
                    </div>
                </div>
            </div>

            <!--                                -->
            <!-- Other items                    -->
            <!--                                -->
            <div *ngIf="items?.length > 0">
                <div id="head_browse_other_items_ID" class="albumLayout">
                    <div class="albumTile" id="{{item.id}}" tabindex="-1"
                        (click)="avtransportService.playResource(item)" *ngFor="let item of items">
                        <div class="albumImageContainer">
                            <img class="image-container" src="{{item.albumArtUrl}}" alt="{{item.title}}">
                        </div>
                        <div class="d-flex flex-column albumDesc">
                            <div class="playlistText">{{getOtherItemHeadline(item)}}</div>
                            <div class="albumTitle">{{item.title}}</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- right outer container end -->
        <div class="middle-spacer">
            &nbsp;
        </div>

    </div>
</div>

<!--                                                                -->
<!-- Template : Missing media server                                -->
<!-- ############################################################## -->
<ng-template #selectServer>
    <div class="regularText infotext">
        Please select a media server or define a default media server
        in the <a href="#/settings">App settings</a>.
    </div>
</ng-template>