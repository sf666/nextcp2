<!--
<div domTreeChange class="bg-default" (dom-changed)="domChange($event)">
  -->

<div domTreeChange class="bg-default" (dom-changed)="domChange($event)">
  <!--                                                                -->
  <!-- Template : Browse Result General Container                     -->
  <!-- ############################################################## -->

  <!-- Top browsing element: Displays image and information about current container -->
  @if (showTopHeader) {
    <div class="pe-2">
      <display-container-header
      [contentDirectoryService]="contentHandler.contentDirectoryService"
      (playClicked)="playPlaylist($event)"
      (shuffleClicked)="shufflePlaylist($event)"
      (playClicked)="playPlaylist($event)"
      (playClicked)="playPlaylist($event)"
      (toggleListViewClicked)="toggleListView()"
      (addToPlaylistClicked)="addPlaylist($event)"
      (toggleLikeAlbumClicked)="toggleLikeAlbum()"      
    />
    </div>
  }

  <!--
Main Content
==========================================
-->
  <div class="outer-container">
    <div class="left-spacer"></div>
    <div class="browseContentArea">
      <!--
    playlist elements on first position
    =================================================================
    -->
      @if (playlistList?.length > 0) {
      <div id="head_browse_result_playlist_items_ID" tabindex="-1">
        <container-tile [smallIcons]="this.allMusicTracks.length > 0" [container]="playlistList"
          (browseClicked)="browseTo($event)" 
          (playClicked)="playPlaylist($event)" 
          (shuffleClicked)="shufflePlaylist($event)" 
          (addPlaylistClicked)="addPlaylist($event)"></container-tile>
      </div>
      }

      <!--                                                                -->
      <!-- Template : Browse Result Album                                 -->
      <!-- ############################################################## -->
      @if (albumList?.length > 0) {
      <div id="head_browse_result_album_ID">
        <container-tile [smallIcons]="this.allMusicTracks.length > 0" [container]="albumList"
          (browseClicked)="browseTo($event)" 
          (playClicked)="playAlbum($event)" 
          (addPlaylistClicked)="addPlaylist($event)"></container-tile>
      </div>
      }


      <!--                                                                -->
      <!-- Template : Browse Result Items                                 -->
      <!-- ############################################################## -->
      @if (allMusicTracks?.length > 0) {
      <div id="top-div" tabindex="-1" class="itemDetails">
        @if (isListView()) {
        <div>
          <div id="head_browse_result_items_list_view_ID" class="container-fluid item-table">
            <div class="item-thead">
              <div class="row col-greyed">
                @if (!allTracksSameAlbum()) {
                <div class="col-3 col-sm-2 col-md-2 col-lg-1">&nbsp;</div>
                }
                @if (allTracksSameAlbum()) {
                <div class="d-flex {{getTitleResponsiveClass()}}">
                  <div class="trackNum">#</div>
                  <div>TITLE</div>
                </div>
                } @else {
                <div class="{{getTitleResponsiveClass()}}">TITLE</div>
                }
                <div class="col-2 d-none d-md-block">ARTIST</div>
                @if (!allTracksSameAlbum()) {
                <div class="col-2 d-none d-xl-block">
                  ALBUM</div>
                }
                @if (extendedApi) {
                <div class="col-1 col-sm-2 d-none text-right d-sm-block">
                  RATING
                </div>
                }
                <div class="col-1 text-right mid-col d-none d-lg-block">LG</div>
                <div class="col-1">&nbsp;</div>
              </div>
            </div>
            <!--                                  -->
            <!-- one item is displayed over a row -->
            <!--                                  -->
            @for (item of allMusicTracks; track item.objectID) {
            <div id="{{item.objectID}}">
              @if (allTracksSameAlbum() && !allTracksSameDisc()) {
              <div class="item-tbody">
                @if (newDiscLabel(item)) {
                <div class="row">
                  <div class="col disc-label">
                    {{getDiscLabel(item)}}
                  </div>
                </div>
                }
              </div>
              }
              <div class="item-tbody">
                <div class="row row-alignment">
                  @if (!allTracksSameAlbum()) {
                  <div class="col-3 col-sm-2 col-md-2 col-lg-1 {{selectedRowClass(item)}}" (click)="play(item)">
                    <img class="img-small imgContainer" src="{{item.albumArtUrl}}">
                  </div>
                  }
                  <div class="{{getTitleResponsiveClass()}} mb-2 mt-2 d-flex flex-column {{selectedRowClass(item)}}">
                    <div (click)="play(item)" class="no-wrap d-flex justify-content-between">
                      <div class="">
                        @if (allTracksSameAlbum()) {
                        <div class="d-flex">
                          <div class="trackNum">{{item.originalTrackNumber}}</div>
                          <div>{{item.title}}</div>
                        </div>
                        } @else {<div>{{item.title}}</div>}
                      </div>
                      <div class="d-none d-md-block">
                        <quality-badge [item]="item"></quality-badge>
                      </div>
                    </div>
                    @if (!allTracksSameAlbum()) {
                    <div (click)="play(item)" class="col-2 no-wrap albumSubtitle d-block d-xl-none">{{item.album}}
                    </div>
                    }
                  </div>
                  <div (click)="play(item)" class="col-2 no-wrap d-none d-md-block {{selectedRowClass(item)}}"> {{item.artistName}}</div>
                  @if (!allTracksSameAlbum()) {
                  <div (click)="play(item)" class="col-2 no-wrap d-none d-xl-block {{selectedRowClass(item)}}">{{item.album}}</div>
                  }
                  @if (extendedApi) {
                  <div class="col-1 col-sm-2 d-none d-sm-block ">
                    <star-rating [currentSong]="item"></star-rating>
                  </div>
                  }
                  <div class="col-1 text-right d-none d-lg-block">{{getDuration(item)}}</div>
                  <div class="col-1 col-greyed" (click)="showSongPopup($event, item)">
                    &#x22EE;
                  </div>
                </div>
              </div>
            </div>
            }
          </div>
        </div>
        } @else {
        <div id="head_browse_result_items_mixed_titles_ID" class="cardLayoutTiles">
          @for (item of allMusicTracks; track item.objectID) {
          <div id="{{item.objectID}}" class="imgCardWidth mb-5 ms-4">
            <div class="albumImageContainer">
              <img src="{{item.albumArtUrl}}" alt="{{item.title}}">
              <div class="overlay-child d-flex flex-column justify-content-end">
                <div class="d-flex justify-content-around align-items-center pb-4">
                  <span class="material-symbols-outlined md-36 m-3" (click)="transportService.playResource(item)">play_circle</span>
                  <span class="material-symbols-outlined md-36 m-3" (click)="playlistService.addToPlaylist(item)">playlist_add</span>
                  <span class="material-symbols-outlined md-36 m-3" (click)="showSongPopup($event, item)">more_vert</span>
                </div>
              </div>
            </div>
            <div class="d-flex card-body">
              <div class="d-flex minWidth">
                <div class="card-title no-wrap">{{item.title}}</div>
              </div>
            </div>
          </div>
          }
        </div>
        }
      </div>
      }

      <!--                                -->
      <!-- General container section      -->
      <!--                                -->
      @if (containerList?.length > 0) {
      <div id="head_browse_result_general_container_ID">
        <container-tile [smallIcons]="this.allMusicTracks.length > 0" [container]="containerList"
          (browseClicked)="browseTo($event)"></container-tile>
      </div>
      }

      <!--                                -->
      <!-- Other items                    -->
      <!--                                -->
      @if (items?.length > 0) {
      <div>
        <div id="head_browse_other_items_ID" class="albumLayout">
          @for (item of items; track item.objectID) {
          <div class="{{getAlbumTile()}}" id="{{item.objectID}}" tabindex="-1" (click)="transportService.playResource(item)">
            <div class="albumImageContainer">
              <img src="{{item.albumArtUrl}}" alt="{{item.title}}">
            </div>
            <div class="d-flex flex-column albumDesc">
              <div class="playlistText">{{getOtherItemHeadline(item)}}</div>
              <div class="{{getAlbumTitle()}}">{{item.title}}</div>
            </div>
          </div>
          }
        </div>
      </div>
      }
    </div>

    <!-- right outer container end -->
    <div class="right-spacer">
      &nbsp;
    </div>
  </div>
</div>